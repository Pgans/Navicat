SELECT a.REG_DATETIME,a.HN,e.STAFF_ID ,c.FNAME , c.LNAME , c.SEX ,FLOOR(DATEDIFF(NOW(),c.BIRTHDATE)/365.25) AS AGE, c.HOME_ADR ,c.TOWN_ID
FROM opd_visits a, cid_hn b, population c, opd_operations d, staff e
WHERE a.REG_DATETIME BETWEEN '20170101' AND '20170131'
AND a.IS_CANCEL = 0
AND a.HN = b.HN
AND b.CID = c.CID
AND a.VISIT_ID = d.VISIT_ID 
AND d.STAFF_ID = e.STAFF_ID
AND d.STAFF_ID IN (0033,0036,0047,0091,0104,1012,0236,0339,0396,0433,0444,0331,0074)
AND FLOOR(DATEDIFF(NOW(),c.BIRTHDATE)/365.25) >= 60
GROUP BY a.HN ORDER BY a.HN
 
