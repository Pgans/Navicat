SET @date1:= '2017-01-01 ';
SET @date2:= '2017-12-31 ';
SELECT  REGDATE,
COUNT(CASE WHEN(CODE ='99.92') THEN '1' END) AS 'Acupuncture',
COUNT(CASE WHEN(CODE BETWEEN '900-77-00' AND '900-77-49') THEN '1' END) AS 'บริบาล',
COUNT(CASE WHEN CODE IN ('875-78-11','900-78-11','590-78-11','724-78-11','874-78-11','590-78-11','9007811','400-78-20','400-78-11','9007818','721-78-11','9007810','876-78-10','876-78-11','873-78-11') THEN 'นวด'  END) AS 'การนวด',
COUNT(CASE WHEN CODE BETWEEN '900-78-00'AND '900-78-08' OR CODE IN('2287420') THEN 'อบ'  END) AS 'อบ',
COUNT(CASE WHEN CODE IN ('875-78-20','900-78-20','9007820','590-78-20','724-78-20','721-78-20','721-78-21','590-78-20','876-78-20','874-78-20','873-78-21') THEN 'ประคบ' END) AS 'ประคบ',
COUNT(CASE WHEN CODE BETWEEN '900-79-00'AND '900-79-99'  THEN 'xx' END) AS 'ส่งเสริม',
COUNT(`CODE`) AS Total
FROM mb_thaimedoper 
WHERE REGDATE BETWEEN @date1 AND @date2
AND INOUTS = 2
GROUP BY REGDATE ORDER BY REGDATE ;


