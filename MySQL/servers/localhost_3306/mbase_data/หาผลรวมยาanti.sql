SELECT c.DRUG_ID, c.DRUG_NAME , c.STRENGTH, c.STRENGTH_UNIT, SUM(b.RX_AMOUNT) AS Amount
FROM  opd_visits a, prescriptions b, drugs c
WHERE a.REG_DATETIME BETWEEN '20161001' AND '20170331'
AND a.VISIT_ID = b.VISIT_ID
AND b.DRUG_ID = c.DRUG_ID
AND a.IS_CANCEL = 0
AND b.IS_CANCEL = 0 
AND c.DRUG_ID IN ( '0041', '0001', '0024' , '0026','0035','0023', '1793','0677','0039','0472','0002','0040','0021','0020','0036','0037','0497')
AND  a.VISIT_ID NOT IN (SELECT VISIT_ID FROM ipd_reg)
GROUP BY c.DRUG_ID