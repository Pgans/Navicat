<<<<<<< HEAD
[2018-05-24 11:54:31.402] [000619] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'lower_case_%'

[2018-05-24 11:54:31.403] [000619] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'profiling'

[2018-05-24 11:54:31.407] [000619] [localhost] [MYSQL]
SHOW DATABASES

[2018-05-24 11:54:35.329] [000620] [localhost] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-05-24 11:54:35.369] [000620] [localhost] [MYSQL]
SHOW FULL TABLES WHERE Table_type != 'VIEW'

[2018-05-24 11:54:47.811] [000622] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:54:47.816] [000622] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:54:47.820] [000622] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:54:47.831] [000622] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:55:03.220] [000621] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:55:03.221] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:55:03.223] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:55:03.244] [000621] [localhost] [MYSQL]
<<<<<<< HEAD

SELECT DISTINCT
refer_no
birthday
tel
marrystatus
nationality
citizenship
religion
occupation
mather_name
father_name
contact_name
contact_relation
contact_addr
=======
SET @vn = '0001907464';

[2018-05-24 11:55:03.244] [000621] [localhost] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '<<<<<<< HEAD

SELECT DISTINCT
refer_no
birthday
tel
marrystatus
nationali' at line 1

[2018-05-24 11:56:06.310] [000621] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:56:06.310] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:56:06.312] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:56:06.322] [000621] [localhost] [MYSQL]
SET @vn = '0001907464';

[2018-05-24 11:56:06.333] [000621] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid as hcode
,concat(gcoffice.offid,'-3-', a.refer_id)  as refer_no
,d.birthdate as birthday
,d.telephone as tel
,d.marriage as marrystatus
,d.natn_id as nationality
,d.oc_id as citizenship
,d.religion as  religion
,d.oc_id as  occupation
,d.mother AS mather_name
,d.father as father_name
,d.contact as contact_name
,'' contact_relation
,d.CONTACT_ADR as contact_addr
FROM gcoffice , refers a
LEFT JOIN opd_visits b ON a.visit_id = b.visit_id AND b.is_cancel = 0
LEFT JOIN cid_hn c ON b.hn = c.hn 
LEFT JOIN population d ON c.cid = d.cid 
WHERE a.visit_id =@vn
AND a.is_cancel = 0

[2018-05-24 11:56:06.859] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:56:06.861] [000621] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:56:06.862] [000621] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.517822*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=8 GROUP BY STATE;

[2018-05-24 11:56:51.981] [000620] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 11:56:51.983] [000620] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 11:56:51.984] [000620] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 11:56:51.987] [000620] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-05-24 11:56:51.988] [000620] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 11:56:56.735] [000621] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:56:56.735] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:56:56.737] [000621] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:56:56.748] [000621] [localhost] [MYSQL]
SET @vn = '0001907464';

[2018-05-24 11:56:56.758] [000621] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid as hcode
,concat(gcoffice.offid,'-3-', a.refer_id)  as refer_no
,d.birthdate as birthday
,d.telephone as tel
,d.marriage as marrystatus
,d.natn_id as nationality
,d.oc_id as citizenship
,d.religion as  religion
,d.oc_id as  occupation
,d.mother AS mather_name
,d.father as father_name
,d.contact as contact_name
,'' contact_relation
,d.CONTACT_ADR as contact_addr
FROM gcoffice , refers a
LEFT JOIN opd_visits b ON a.visit_id = b.visit_id AND b.is_cancel = 0
LEFT JOIN cid_hn c ON b.hn = c.hn 
LEFT JOIN population d ON c.cid = d.cid 
WHERE a.visit_id =@vn
AND a.is_cancel = 0

xxxx

[2018-05-24 11:56:56.759] [000621] [localhost] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'xxxx' at line 23

=======
[2018-05-24 09:27:59.957] [179430] [smart_refer_ubon] [MYSQL]
SHOW VARIABLES LIKE 'lower_case_%'

[2018-05-24 09:27:59.988] [179430] [smart_refer_ubon] [MYSQL]
SHOW VARIABLES LIKE 'profiling'

[2018-05-24 09:28:00.035] [179430] [smart_refer_ubon] [MYSQL]
SHOW DATABASES

[2018-05-24 09:28:02.617] [179431] [smart_refer_ubon] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-05-24 09:28:02.695] [179431] [smart_refer_ubon] [MYSQL]
SHOW FULL TABLES WHERE Table_type != 'VIEW'

[2018-05-24 09:28:17.891] [179430] [smart_refer_ubon] [MYSQL]
SHOW CHARACTER SET

[2018-05-24 09:28:17.922] [179430] [smart_refer_ubon] [MYSQL]
SHOW COLLATION

[2018-05-24 09:28:18.032] [179431] [smart_refer_ubon] [MYSQL]
SHOW ENGINES

[2018-05-24 09:28:18.079] [179431] [smart_refer_ubon] [MYSQL]
SHOW TABLE STATUS LIKE 'referout'

[2018-05-24 09:28:18.110] [179431] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 09:28:18.141] [179431] [smart_refer_ubon] [MYSQL]
SELECT TABLE_NAME, PARTITION_NAME, SUBPARTITION_NAME, PARTITION_METHOD, SUBPARTITION_METHOD, PARTITION_EXPRESSION, SUBPARTITION_EXPRESSION, PARTITION_DESCRIPTION, PARTITION_COMMENT, NODEGROUP, TABLESPACE_NAME FROM information_schema.PARTITIONS WHERE TABLE_SCHEMA LIKE 'smartrefer_db' AND NOT ISNULL(PARTITION_NAME) AND TABLE_NAME LIKE 'referout' ORDER BY TABLE_NAME, PARTITION_NAME, PARTITION_ORDINAL_POSITION, SUBPARTITION_ORDINAL_POSITION

[2018-05-24 09:28:18.188] [179431] [smart_refer_ubon] [MYSQL]
SHOW FULL COLUMNS FROM `referout`

[2018-05-24 09:28:18.219] [179431] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 09:28:18.251] [179431] [smart_refer_ubon] [MYSQL]
SELECT * FROM `information_schema`.`columns` WHERE TABLE_NAME='referout' AND TABLE_SCHEMA='smartrefer_db'

[2018-05-24 09:28:18.282] [179431] [smart_refer_ubon] [MYSQL]
SHOW INDEX FROM `referout`

[2018-05-24 09:28:18.320] [179431] [smart_refer_ubon] [MYSQL]
SELECT trigger_name, event_manipulation, event_object_table, action_statement, action_timing, DEFINER FROM information_schema.triggers WHERE BINARY event_object_schema='smartrefer_db' AND BINARY event_object_table='referout'

[2018-05-24 09:28:18.351] [179431] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 09:28:39.539] [000062] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'lower_case_%'

[2018-05-24 09:28:39.539] [000062] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'profiling'

[2018-05-24 09:28:39.554] [000062] [localhost] [MYSQL]
SHOW DATABASES

[2018-05-24 09:28:41.259] [000063] [localhost] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-05-24 09:28:41.306] [000063] [localhost] [MYSQL]
SHOW FULL TABLES WHERE Table_type != 'VIEW'

[2018-05-24 09:29:09.738] [000065] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 09:29:09.785] [000065] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 09:29:09.816] [000065] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 09:29:09.816] [000065] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 09:29:43.788] [000064] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 09:29:43.788] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 09:29:43.819] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 09:29:43.819] [000064] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001941388';

[2018-05-24 09:29:43.835] [000064] [localhost] [MYSQL]
SELECT
gcoffice.offid  hcode
, CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, '1' refertype_id
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
,DATE_FORMAT(a.RF_DT,'%H%i') refer_time
,CASE
WHEN a.UNIT_ID IN ( 02,12,13,14,15,16,17,18,19,20,27) THEN '1'
WHEN a.UNIT_ID = 11 THEN '3'
WHEN a.UNIT_ID IN (38,39) THEN '2'
WHEN a.UNIT_ID = 22 THEN '4'
END AS  station_id
,CASE
WHEN a.UNIT_ID = 01 THEN '001'
WHEN a.UNIT_ID = 02 THEN '002'
WHEN a.UNIT_ID = 08 THEN '007'
WHEN a.UNIT_ID = 11 THEN '023'
WHEN a.UNIT_ID = 26  THEN '015'
WHEN a.UNIT_ID = 22 THEN '036'
WHEN a.UNIT_ID IN (38,39) THEN '026'
WHEN a.UNIT_ID IN (03,04,05) THEN '004'
WHEN a.UNIT_ID =31 THEN '013'
WHEN a.UNIT_ID IN (12,13,14,15,16,17,18,19,20,27) THEN '020'
END AS location_id
,v.HN  pid
,c.CID cid
,v.HN hn
, i.ADM_ID an
,a.VISIT_ID vn
,CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
, p.FNAME fname
, p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,p.HOME_ADR addrpart
,SUBSTR(p.TOWN_ID,7,2) moopart
,SUBSTR(p.TOWN_ID,5,2) tmbpart
,SUBSTR(p.TOWN_ID,3,2) amppart
,SUBSTR(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID pttypeno
,u.HOSPMAIN  hospmain
,u.HOSPSUB hospsub
,'' typept_id
,'' strength_id
, a.STAFF_ID doctor_id
,a.HOSP_ID  refer_hospcode
, '' cause_referout_id
,'' expire_date
,'' loads_id
,'' is_coordinate_doctor
,'' is_coordinate_nurse
,'' coordinate_id
,'' is_coordinate_result
,'' hospcode_deny_complete
,'' is_upload
,'' is_download
,'' is_receive
,'' is_cancel
,'' is_referboard
,'' is_deny
,'' refer_type
,'' refer_station_id
,'' diag_text
,'' serviceplan_id
,'' caretype_id
,'' refer_result
,'' is_appoint
,'' is_refer_result
,'' is_send_back
,'' is_send_pack
,'' is_care_plan
FROM gcoffice, refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
LEFT JOIN cid_hn c ON v.HN = c.HN 
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN ipd_reg i ON v.VISIT_ID = i.VISIT_ID AND i.IS_CANCEL = 0
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT = 0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE  a.RF_TYPE= 2
AND a.VISIT_ID = @vn

[2018-05-24 09:29:46.335] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 09:29:46.335] [000064] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 09:29:46.335] [000064] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/2.488637*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 09:53:06.911] [179431] [smart_refer_ubon] [MYSQL]
SHOW ENGINES

[2018-05-24 09:53:06.911] [179431] [smart_refer_ubon] [MYSQL]
2013 - Lost connection to MySQL server during query

[2018-05-24 09:53:07.052] [179491] [smart_refer_ubon] [MYSQL]
SHOW ENGINES

[2018-05-24 09:53:07.114] [179491] [smart_refer_ubon] [MYSQL]
SHOW TABLE STATUS LIKE 'referout'

[2018-05-24 09:53:07.145] [179491] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 09:53:07.177] [179491] [smart_refer_ubon] [MYSQL]
SELECT TABLE_NAME, PARTITION_NAME, SUBPARTITION_NAME, PARTITION_METHOD, SUBPARTITION_METHOD, PARTITION_EXPRESSION, SUBPARTITION_EXPRESSION, PARTITION_DESCRIPTION, PARTITION_COMMENT, NODEGROUP, TABLESPACE_NAME FROM information_schema.PARTITIONS WHERE TABLE_SCHEMA LIKE 'smartrefer_db' AND NOT ISNULL(PARTITION_NAME) AND TABLE_NAME LIKE 'referout' ORDER BY TABLE_NAME, PARTITION_NAME, PARTITION_ORDINAL_POSITION, SUBPARTITION_ORDINAL_POSITION

[2018-05-24 09:53:07.208] [179491] [smart_refer_ubon] [MYSQL]
SHOW FULL COLUMNS FROM `referout`

[2018-05-24 09:53:07.239] [179491] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 09:53:07.270] [179491] [smart_refer_ubon] [MYSQL]
SELECT * FROM `information_schema`.`columns` WHERE TABLE_NAME='referout' AND TABLE_SCHEMA='smartrefer_db'

[2018-05-24 09:53:07.302] [179491] [smart_refer_ubon] [MYSQL]
SHOW INDEX FROM `referout`

[2018-05-24 09:53:07.333] [179491] [smart_refer_ubon] [MYSQL]
SELECT trigger_name, event_manipulation, event_object_table, action_statement, action_timing, DEFINER FROM information_schema.triggers WHERE BINARY event_object_schema='smartrefer_db' AND BINARY event_object_table='referout'

[2018-05-24 09:53:07.380] [179491] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referout`

[2018-05-24 10:00:01.292] [000066] [localhost] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-05-24 10:00:01.338] [000066] [localhost] [MYSQL]
SHOW FULL TABLES WHERE Table_type != 'VIEW'

[2018-05-24 10:00:35.338] [000067] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:00:35.338] [000067] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:00:35.353] [000067] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:00:35.369] [000067] [localhost] [MYSQL]
SELECT DISTINCT '10953' AS HOSPCODE,
cid_hn.HN AS PID,  
opd_visits.VISIT_ID as SEQ,  
DATE_FORMAT(opd_visits.REG_DATETIME,'%Y%m%d') AS DATE_SERV,
opd_visits.STAFF_ID AS NUTRITIONPLACE,
FORMAT(opd_visits.WEIGHT,1) AS WEIGHT,
opd_visits.HEIGHT AS HEIGHT,
'' AS HEADCIRCUM,
'' AS CHILDDEVELOP,
'' AS FOOD,
'' AS BOTTLE,
'' AS PROVIDER,
DATE_FORMAT(NOW(),'%Y%m%d%H%i%s') AS D_UPDATE
FROM 
	population 
	INNER JOIN cid_hn ON population.CID = cid_hn.CID 
	INNER JOIN opd_visits ON cid_hn.hn = opd_visits.HN
	INNER JOIN opd_operations ON opd_operations.VISIT_ID = opd_visits.VISIT_ID
	INNER JOIN icd9cm ON opd_operations.ICD9_ID = icd9cm.ICD9_ID
	inner join opd_diagnosis on opd_visits.visit_id = opd_diagnosis.VISIT_ID and opd_diagnosis.DXT_ID='1'

WHERE 
1 = 1	
	AND LEFT( population.cid, 5 ) > 00000 
  AND opd_visits.reg_datetime BETWEEN '2014.01.01 00:00' AND '2014.01.31 23:59' 
  AND opd_visits.is_cancel = 0
	AND FLOOR(DATEDIFF(NOW(),population.BIRTHDATE)/365.25) >=0 AND FLOOR(DATEDIFF(NOW(),population.BIRTHDATE)/365.25) <6
	AND opd_visits.visit_id NOT IN( SELECT visit_id FROM ipd_reg )
ORDER BY population.CID;

[2018-05-24 10:00:35.369] [000067] [localhost] [MYSQL]
1146 - Table 'dhdc.population' doesn't exist

[2018-05-24 10:00:35.400] [000068] [localhost] [MYSQL]
SHOW FULL TABLES FROM `dhdc` WHERE Table_type != 'VIEW'

[2018-05-24 10:00:35.432] [000068] [localhost] [MYSQL]
SHOW FULL TABLES FROM `dhdc` WHERE Table_type = 'VIEW'

[2018-05-24 10:00:35.448] [000068] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='dhdc'

[2018-05-24 10:00:35.448] [000068] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='dhdc'

[2018-05-24 10:01:14.179] [000063] [localhost] [MYSQL]
SHOW CREATE TABLE `opd_visits`

[2018-05-24 10:01:14.210] [000069] [localhost] [MYSQL]
SELECT * FROM `opd_visits` LIMIT 0, 1000

[2018-05-24 10:01:14.226] [000069] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:01:51.870] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:02:36.040] [000064] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:02:36.040] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:02:36.040] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:02:36.056] [000064] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001941388';

[2018-05-24 10:02:36.056] [000064] [localhost] [MYSQL]
SELECT
gcoffice.offid  hcode
, CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, '1' refertype_id
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
,DATE_FORMAT(a.RF_DT,'%H%i') refer_time
,CASE
WHEN a.UNIT_ID IN ( 02,12,13,14,15,16,17,18,19,20,27) THEN '1'
WHEN a.UNIT_ID = 11 THEN '3'
WHEN a.UNIT_ID IN (38,39) THEN '2'
WHEN a.UNIT_ID = 22 THEN '4'
END AS  station_id
,CASE
WHEN a.UNIT_ID = 01 THEN '001'
WHEN a.UNIT_ID = 02 THEN '002'
WHEN a.UNIT_ID = 08 THEN '007'
WHEN a.UNIT_ID = 11 THEN '023'
WHEN a.UNIT_ID = 26  THEN '015'
WHEN a.UNIT_ID = 22 THEN '036'
WHEN a.UNIT_ID IN (38,39) THEN '026'
WHEN a.UNIT_ID IN (03,04,05) THEN '004'
WHEN a.UNIT_ID =31 THEN '013'
WHEN a.UNIT_ID IN (12,13,14,15,16,17,18,19,20,27) THEN '020'
END AS location_id
,v.HN  pid
,c.CID cid
,v.HN hn
, i.ADM_ID an
,a.VISIT_ID vn
,CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
, p.FNAME fname
, p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,v.WEIGHT body_weight_kg
,v.HEIGHT height_cm
,'' bloodgroup
,p.HOME_ADR addrpart
,SUBSTR(p.TOWN_ID,7,2) moopart
,SUBSTR(p.TOWN_ID,5,2) tmbpart
,SUBSTR(p.TOWN_ID,3,2) amppart
,SUBSTR(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID pttypeno
,u.HOSPMAIN  hospmain
,u.HOSPSUB hospsub
,'' typept_id
,'' strength_id
, a.STAFF_ID doctor_id
,'' refer_hospcode
, '' cause_referout_id
,'' expire_date
,'' loads_id
,'' is_coordinate_doctor
,'' is_coordinate_nurse
,'' coordinate_id
,'' is_coordinate_result
,'' hospcode_deny_complete
,'' is_upload
,'' is_download
,'' is_receive
,'' is_cancel
,'' is_referboard
,'' is_deny
,'' refer_type
,'' refer_station_id
,'' diag_text
,'' serviceplan_id
,'' caretype_id
,'' refer_result
,'' is_appoint
,'' is_refer_result
,'' is_send_back
,'' is_send_pack
,'' is_care_plan
FROM gcoffice, refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
LEFT JOIN cid_hn c ON v.HN = c.HN 
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN ipd_reg i ON v.VISIT_ID = i.VISIT_ID AND i.IS_CANCEL = 0
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT = 0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE  a.RF_TYPE= 2
AND a.VISIT_ID = @vn

[2018-05-24 10:02:36.134] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:02:36.150] [000064] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:02:36.150] [000064] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.068094*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=12 GROUP BY STATE;

[2018-05-24 10:03:21.015] [000063] [localhost] [MYSQL]
SHOW CREATE TABLE `population`

[2018-05-24 10:03:21.062] [000070] [localhost] [MYSQL]
SELECT * FROM `population` LIMIT 0, 1000

[2018-05-24 10:03:21.078] [000070] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 10:04:00.815] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 10:04:05.847] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 10:04:05.863] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 10:04:05.863] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-05-24 10:04:05.863] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`ipd_reg`

[2018-05-24 10:04:05.863] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`uc_inscl`

[2018-05-24 10:04:05.878] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`main_inscls`

[2018-05-24 10:04:11.123] [000064] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:04:11.123] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:04:11.123] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:04:11.139] [000064] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001941388';

[2018-05-24 10:04:11.139] [000064] [localhost] [MYSQL]
SELECT
gcoffice.offid  hcode
, CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, '1' refertype_id
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
,DATE_FORMAT(a.RF_DT,'%H%i') refer_time
,CASE
WHEN a.UNIT_ID IN ( 02,12,13,14,15,16,17,18,19,20,27) THEN '1'
WHEN a.UNIT_ID = 11 THEN '3'
WHEN a.UNIT_ID IN (38,39) THEN '2'
WHEN a.UNIT_ID = 22 THEN '4'
END AS  station_id
,CASE
WHEN a.UNIT_ID = 01 THEN '001'
WHEN a.UNIT_ID = 02 THEN '002'
WHEN a.UNIT_ID = 08 THEN '007'
WHEN a.UNIT_ID = 11 THEN '023'
WHEN a.UNIT_ID = 26  THEN '015'
WHEN a.UNIT_ID = 22 THEN '036'
WHEN a.UNIT_ID IN (38,39) THEN '026'
WHEN a.UNIT_ID IN (03,04,05) THEN '004'
WHEN a.UNIT_ID =31 THEN '013'
WHEN a.UNIT_ID IN (12,13,14,15,16,17,18,19,20,27) THEN '020'
END AS location_id
,v.HN  pid
,c.CID cid
,v.HN hn
, i.ADM_ID an
,a.VISIT_ID vn
,CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
, p.FNAME fname
, p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,v.WEIGHT body_weight_kg
,v.HEIGHT height_cm
,p.bl_group  bloodgroup
,p.HOME_ADR addrpart
,SUBSTR(p.TOWN_ID,7,2) moopart
,SUBSTR(p.TOWN_ID,5,2) tmbpart
,SUBSTR(p.TOWN_ID,3,2) amppart
,SUBSTR(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID pttypeno
,u.HOSPMAIN  hospmain
,u.HOSPSUB hospsub
,'' typept_id
,'' strength_id
, a.STAFF_ID doctor_id
,'' refer_hospcode
, '' cause_referout_id
,'' expire_date
,'' loads_id
,'' is_coordinate_doctor
,'' is_coordinate_nurse
,'' coordinate_id
,'' is_coordinate_result
,'' hospcode_deny_complete
,'' is_upload
,'' is_download
,'' is_receive
,'' is_cancel
,'' is_referboard
,'' is_deny
,'' refer_type
,'' refer_station_id
,'' diag_text
,'' serviceplan_id
,'' caretype_id
,'' refer_result
,'' is_appoint
,'' is_refer_result
,'' is_send_back
,'' is_send_pack
,'' is_care_plan
FROM gcoffice, refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
LEFT JOIN cid_hn c ON v.HN = c.HN 
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN ipd_reg i ON v.VISIT_ID = i.VISIT_ID AND i.IS_CANCEL = 0
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT = 0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE  a.RF_TYPE= 2
AND a.VISIT_ID = @vn

[2018-05-24 10:04:11.217] [000064] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:04:11.217] [000064] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:04:11.217] [000064] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.063066*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=20 GROUP BY STATE;

[2018-05-24 10:07:04.416] [000072] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:07:04.479] [000072] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:07:04.510] [000072] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:07:04.510] [000072] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:07:33.617] [000071] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:07:33.617] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:07:33.617] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:07:33.633] [000071] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001909085';

[2018-05-24 10:07:33.648] [000071] [localhost] [MYSQL]
SELECT
 gcoffice.offid  AS hcode, CONCAT(gcoffice.offid,'-3-', a.refer_id) referback_no
,' ' referback_no_his
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
, DATE_FORMAT(a.RF_DT,'%H%i') refer_time
, p.CID cid,
CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
,p.FNAME fname
,p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,p.HOME_ADR addrpart
,substr(p.TOWN_ID,7,2) moopart
,substr(p.TOWN_ID,5,2) tmbpart
,substr(p.TOWN_ID,3,2)  amppart
,substr(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID  pttypeno
,'' loads_id
,a.STAFF_ID doctor_id
,'' refer_hospcode
, '' eye_opening
,'' verbal_response
,'' motor_response
,'' pupil
,'' cause_referback_id
, '' diag_text
,' ' referback_result
, '' is_upload
, '' is_download
, '' is_receive
,'' hn
,'' station_ID
,'' location_ID
,'' word_call_man
,'' word_call_status
,'' refercenter_receive_doc
,'' refercenter_receive_date
,'' refercenter_receive_time
,'' refercenter_receive_man
,'' refercenter_receive_status
,'' end_refercenter_result
,'' end_refercenter_transport
,'' end_refercenter_date
,'' end_refercenter_time
,'' end_refercenter_man
,'' end_refercenter_status
,'' receive_patient_back_date
,'' receive_patient_back_time
,'' receive_patient_back_man
,'' receive_patient_back_status
,'' is_send_pacs
FROM  gcoffice , refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
INNER JOIN cid_hn c ON v.HN = c.HN
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN service_units s ON a.UNIT_ID = s.UNIT_ID
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT =0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE 
a.VISIT_ID = @vn
AND a.RF_TYPE = 1
AND LEFT(a.HOSP_ID,3) NOT IN ( 037,036)
AND a.HOSP_ID NOT IN  (10953, 99809)

[2018-05-24 10:07:33.758] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:07:33.758] [000071] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:07:33.758] [000071] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.084666*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 10:08:23.533] [179491] [smart_refer_ubon] [MYSQL]
SHOW ENGINES

[2018-05-24 10:08:23.533] [179491] [smart_refer_ubon] [MYSQL]
2013 - Lost connection to MySQL server during query

[2018-05-24 10:08:23.689] [179530] [smart_refer_ubon] [MYSQL]
SHOW ENGINES

[2018-05-24 10:08:23.751] [179530] [smart_refer_ubon] [MYSQL]
SHOW TABLE STATUS LIKE 'referback'

[2018-05-24 10:08:23.799] [179530] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referback`

[2018-05-24 10:08:23.845] [179530] [smart_refer_ubon] [MYSQL]
SELECT TABLE_NAME, PARTITION_NAME, SUBPARTITION_NAME, PARTITION_METHOD, SUBPARTITION_METHOD, PARTITION_EXPRESSION, SUBPARTITION_EXPRESSION, PARTITION_DESCRIPTION, PARTITION_COMMENT, NODEGROUP, TABLESPACE_NAME FROM information_schema.PARTITIONS WHERE TABLE_SCHEMA LIKE 'smartrefer_db' AND NOT ISNULL(PARTITION_NAME) AND TABLE_NAME LIKE 'referback' ORDER BY TABLE_NAME, PARTITION_NAME, PARTITION_ORDINAL_POSITION, SUBPARTITION_ORDINAL_POSITION

[2018-05-24 10:08:23.877] [179530] [smart_refer_ubon] [MYSQL]
SHOW FULL COLUMNS FROM `referback`

[2018-05-24 10:08:23.924] [179530] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referback`

[2018-05-24 10:08:23.955] [179530] [smart_refer_ubon] [MYSQL]
SELECT * FROM `information_schema`.`columns` WHERE TABLE_NAME='referback' AND TABLE_SCHEMA='smartrefer_db'

[2018-05-24 10:08:23.986] [179530] [smart_refer_ubon] [MYSQL]
SHOW INDEX FROM `referback`

[2018-05-24 10:08:24.033] [179530] [smart_refer_ubon] [MYSQL]
SELECT trigger_name, event_manipulation, event_object_table, action_statement, action_timing, DEFINER FROM information_schema.triggers WHERE BINARY event_object_schema='smartrefer_db' AND BINARY event_object_table='referback'

[2018-05-24 10:08:24.064] [179530] [smart_refer_ubon] [MYSQL]
SHOW CREATE TABLE `referback`

[2018-05-24 10:09:16.292] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:09:48.894] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 10:09:48.926] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 10:09:48.941] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-05-24 10:09:48.941] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 10:09:48.957] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`service_units`

[2018-05-24 10:09:48.957] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`uc_inscl`

[2018-05-24 10:09:48.957] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`main_inscls`

[2018-05-24 10:10:08.438] [000071] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:10:08.438] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:10:08.438] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:10:08.438] [000071] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001909085';

[2018-05-24 10:10:08.453] [000071] [localhost] [MYSQL]
SELECT
 gcoffice.offid  AS hcode, CONCAT(gcoffice.offid,'-3-', a.refer_id) referback_no
,' ' referback_no_his
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
, DATE_FORMAT(a.RF_DT,'%H%i') refer_time
, p.CID cid,
CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
,p.FNAME fname
,p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,v.WEIGHT  as body_weight_kg
,v.HEIGHT as height_cm
,p.bl_group as  bloodgroup
,p.HOME_ADR addrpart
,substr(p.TOWN_ID,7,2) moopart
,substr(p.TOWN_ID,5,2) tmbpart
,substr(p.TOWN_ID,3,2)  amppart
,substr(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID  pttypeno
,'' loads_id
,a.STAFF_ID doctor_id
,'' refer_hospcode
, '' eye_opening
,'' verbal_response
,'' motor_response
,'' pupil
,'' cause_referback_id
, '' diag_text
,' ' referback_result
, '' is_upload
, '' is_download
, '' is_receive
,'' hn
,'' station_ID
,'' location_ID
,'' word_call_man
,'' word_call_status
,'' refercenter_receive_doc
,'' refercenter_receive_date
,'' refercenter_receive_time
,'' refercenter_receive_man
,'' refercenter_receive_status
,'' end_refercenter_result
,'' end_refercenter_transport
,'' end_refercenter_date
,'' end_refercenter_time
,'' end_refercenter_man
,'' end_refercenter_status
,'' receive_patient_back_date
,'' receive_patient_back_time
,'' receive_patient_back_man
,'' receive_patient_back_status
,'' is_send_pacs
FROM  gcoffice , refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
INNER JOIN cid_hn c ON v.HN = c.HN
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN service_units s ON a.UNIT_ID = s.UNIT_ID
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT =0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE 
a.VISIT_ID = @vn
AND a.RF_TYPE = 1
AND LEFT(a.HOSP_ID,3) NOT IN ( 037,036)
AND a.HOSP_ID NOT IN  (10953, 99809)

[2018-05-24 10:10:08.531] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:10:08.531] [000071] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:10:08.531] [000071] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.062582*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=12 GROUP BY STATE;

[2018-05-24 10:10:31.946] [000063] [localhost] [MYSQL]
SHOW CREATE TABLE `opd_visits`

[2018-05-24 10:10:31.993] [000073] [localhost] [MYSQL]
SELECT * FROM `opd_visits` LIMIT 0, 1000

[2018-05-24 10:10:31.993] [000073] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:10:35.824] [000073] [localhost] [MYSQL]
SELECT COUNT(1) FROM `opd_visits`

[2018-05-24 10:10:36.558] [000073] [localhost] [MYSQL]
SELECT * FROM `opd_visits` LIMIT 1815000, 1000

[2018-05-24 10:10:41.496] [000073] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:11:16.173] [000071] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:11:16.173] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:11:16.173] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:11:16.189] [000071] [localhost] [MYSQL]
#SET @vn = ?p0;
SET @vn = '0001909085';

[2018-05-24 10:11:16.189] [000071] [localhost] [MYSQL]
SELECT
 gcoffice.offid  AS hcode, CONCAT(gcoffice.offid,'-3-', a.refer_id) referback_no
,' ' referback_no_his
,DATE_FORMAT(a.RF_DT,'%Y%m%d')  refer_date
, DATE_FORMAT(a.RF_DT,'%H%i') refer_time
, p.CID cid,
CASE 
	WHEN PRENAME not in('') THEN PRENAME
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '20' AND sex='1' AND MARRIAGE = '4'THEN 'สามเณร'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '20' AND sex='1' AND MARRIAGE = '4'THEN 'พระภิกษุ'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='1' THEN 'เด็กชาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='1' THEN 'นาย'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 < '15'  AND sex='2' THEN 'เด็กหญิง'
	WHEN DATEDIFF(now(),BIRTHDATE)/365.25 >= '15' AND sex='2' AND MARRIAGE='1' THEN 'นางสาว'
ELSE 'นาง'
END AS pname
,p.FNAME fname
,p.LNAME lname
,CONCAT(timestampdiff(year,p.BIRTHDATE,a.RF_DT) ,'-',timestampdiff(month,p.BIRTHDATE,a.RF_DT)-(timestampdiff(year,p.BIRTHDATE,a.RF_DT)*12) 
,'-',timestampdiff(day,date_add(p.BIRTHDATE,interval (timestampdiff(month,p.BIRTHDATE,a.RF_DT)) month),a.RF_DT)) AS age
,v.WEIGHT  as body_weight_kg
,v.HEIGHT as height_cm
,p.bl_group as  bloodgroup
,p.HOME_ADR addrpart
,substr(p.TOWN_ID,7,2) moopart
,substr(p.TOWN_ID,5,2) tmbpart
,substr(p.TOWN_ID,3,2)  amppart
,substr(p.TOWN_ID,1,2) chwpart
,CASE
WHEN m.INSCL IN (03,04) THEN '89'
END AS pttype_id
,u.UC_CARDID  pttypeno
,'' loads_id
,a.STAFF_ID doctor_id
,'' refer_hospcode
, '' eye_opening
,'' verbal_response
,'' motor_response
,'' pupil
,'' cause_referback_id
, '' diag_text
,' ' referback_result
, '' is_upload
, '' is_download
, '' is_receive
,'' hn
,'' station_ID
,'' location_ID
,'' word_call_man
,'' word_call_status
,'' refercenter_receive_doc
,'' refercenter_receive_date
,'' refercenter_receive_time
,'' refercenter_receive_man
,'' refercenter_receive_status
,'' end_refercenter_result
,'' end_refercenter_transport
,'' end_refercenter_date
,'' end_refercenter_time
,'' end_refercenter_man
,'' end_refercenter_status
,'' receive_patient_back_date
,'' receive_patient_back_time
,'' receive_patient_back_man
,'' receive_patient_back_status
,'' is_send_pacs
FROM  gcoffice , refers a
LEFT JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND v.IS_CANCEL = 0
INNER JOIN cid_hn c ON v.HN = c.HN
LEFT JOIN population p ON c.CID = p.CID
LEFT JOIN service_units s ON a.UNIT_ID = s.UNIT_ID
LEFT JOIN uc_inscl u ON p.CID = u.CID AND u.DATE_ABORT =0
LEFT JOIN main_inscls m ON v.INSCL = m.INSCL
WHERE 
a.VISIT_ID = @vn
AND a.RF_TYPE = 1
AND LEFT(a.HOSP_ID,3) NOT IN ( 037,036)
AND a.HOSP_ID NOT IN  (10953, 99809)

[2018-05-24 10:11:16.851] [000071] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:11:16.851] [000071] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:11:16.851] [000071] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.648398*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=20 GROUP BY STATE;

[2018-05-24 10:21:06.564] [000075] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:21:06.627] [000075] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:21:06.658] [000075] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:21:06.658] [000075] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:21:17.166] [000074] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:21:17.166] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:21:17.166] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:21:17.181] [000074] [localhost] [MYSQL]
SET @vn = '0001907500';

[2018-05-24 10:21:17.181] [000074] [localhost] [MYSQL]
SET @vni = (select   visit_id FROM ipd_reg limit 1);

[2018-05-24 10:21:17.197] [000074] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, a.VISIT_ID vn
, c.HN hn
,'' order_no
,'' item_no
,'' rxdate
,'' rxtime
,'' date_serv
,CONCAT('01', v.UNIT_REG, a.UNIT_ID)  clinic
,dr.DIDSTD didstd
,dr.DRUG_NAME dname
,b.RX_AMOUNT amount
,dr.UUNIT_ID unit
,d.UUNIT_NAME unit_packing
,dp.price_1 drugprice
,dr.PRICE drugcost
,a.STAFF_ID  provider
,CONCAT(TRIM(p.FNAME),' ',TRIM(p.LNAME) ) provider_name
,s. LICENCE provider_licenseno
,s.CID provider_cid
,r.ROUTE_THAI drugusage_text
FROM gcoffice, refers a
INNER JOIN staff s ON a.STAFF_ID  = s.STAFF_ID
INNER JOIN population p ON p.CID = s.CID
INNER JOIN cid_hn c ON c.CID = p.CID
INNER  JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND  v.IS_CANCEL = 0
INNER JOIN prescriptions b ON v.visit_id = b.visit_id  AND b.IS_CANCEL = 0
INNER JOIN drugs  dr ON b.drug_id = dr.drug_id 
LEFT OUTER JOIN usage_units d ON dr.PACKAGE = d.UUNIT_ID
INNER JOIN service_units sv ON sv.UNIT_ID = a.UNIT_ID
INNER JOIN routes r ON r.ROUTE_ID = b.ROUTE_ID
INNER JOIN drug_price dp ON dp.drug_id = dr.DRUG_ID 
WHERE a.VISIT_ID =@vn
AND v.VISIT_ID NOT IN (@vni)

[2018-05-24 10:21:17.307] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:21:17.307] [000074] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:21:17.307] [000074] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.093486*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=5 GROUP BY STATE;

[2018-05-24 10:23:19.852] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 10:23:19.852] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 10:23:19.867] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`staff`

[2018-05-24 10:23:19.883] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 10:23:19.883] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-05-24 10:23:19.883] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 10:23:19.899] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`prescriptions`

[2018-05-24 10:23:19.899] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`drugs`

[2018-05-24 10:23:19.899] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`usage_units`

[2018-05-24 10:23:19.899] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`service_units`

[2018-05-24 10:23:19.916] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`routes`

[2018-05-24 10:23:19.918] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`drug_price`

[2018-05-24 10:23:59.955] [000074] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:23:59.955] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:23:59.955] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:23:59.955] [000074] [localhost] [MYSQL]
SET @vn = '0001907500';

[2018-05-24 10:23:59.971] [000074] [localhost] [MYSQL]
SET @vni = (select   visit_id FROM ipd_reg limit 1);

[2018-05-24 10:23:59.986] [000074] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, a.VISIT_ID vn
, c.HN hn
,'' order_no
,'' item_no
,'' rxdate
,'' rxtime
,date_format(v.REG_DATETIME,'%y%m%d') date_serv
,CONCAT('01', v.UNIT_REG, a.UNIT_ID)  clinic
,dr.DIDSTD didstd
,dr.DRUG_NAME dname
,b.RX_AMOUNT amount
,dr.UUNIT_ID unit
,d.UUNIT_NAME unit_packing
,dp.price_1 drugprice
,dr.PRICE drugcost
,a.STAFF_ID  provider
,CONCAT(TRIM(p.FNAME),' ',TRIM(p.LNAME) ) provider_name
,s. LICENCE provider_licenseno
,s.CID provider_cid
,r.ROUTE_THAI drugusage_text
FROM gcoffice, refers a
INNER JOIN staff s ON a.STAFF_ID  = s.STAFF_ID
INNER JOIN population p ON p.CID = s.CID
INNER JOIN cid_hn c ON c.CID = p.CID
INNER  JOIN opd_visits v ON a.VISIT_ID = v.VISIT_ID AND  v.IS_CANCEL = 0
INNER JOIN prescriptions b ON v.visit_id = b.visit_id  AND b.IS_CANCEL = 0
INNER JOIN drugs  dr ON b.drug_id = dr.drug_id 
LEFT OUTER JOIN usage_units d ON dr.PACKAGE = d.UUNIT_ID
INNER JOIN service_units sv ON sv.UNIT_ID = a.UNIT_ID
INNER JOIN routes r ON r.ROUTE_ID = b.ROUTE_ID
INNER JOIN drug_price dp ON dp.drug_id = dr.DRUG_ID 
WHERE a.VISIT_ID =@vn
AND v.VISIT_ID NOT IN (@vni)

[2018-05-24 10:24:00.064] [000074] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:24:00.064] [000074] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:24:00.064] [000074] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.072871*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=14 GROUP BY STATE;

[2018-05-24 10:25:58.178] [000077] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:25:58.288] [000077] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:25:58.334] [000077] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:25:58.366] [000077] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:26:01.000] [000076] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:26:01.000] [000076] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:26:01.000] [000076] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:26:01.016] [000076] [localhost] [MYSQL]
SET @an ='077448';

[2018-05-24 10:26:01.031] [000076] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
, i.ADM_ID an
,v.HN  hn
,'' order_no
,'' item_no
,r.ROUTE_THAI drugusage_text
,i.ADM_DT datetime_admit
,'' datetime_rx
,CONCAT('01',v.UNIT_REG,i.WARD_NO) wardstay
,i.WARD_NO ward_code
,su.UNIT_NAME  ward_name
,'' typedrug
, dr.DIDSTD didstd
,dr.DRUG_NAME dname
,'' datestart
,'' datefinish
,ps.RX_AMOUNT amount
,dr.UUNIT_ID  unit
,d.UUNIT_NAME unit_packing
,dp.price_1 drugprice
,dr.PRICE drugcost
,a.STAFF_ID provider
,CONCAT(TRIM(p.FNAME),' ',TRIM(p.LNAME) ) provider_name
,s.LICENCE provider_licenseno
,s.CID provider_cid
FROM gcoffice, ipd_reg i
INNER  JOIN refers a ON a.VISIT_ID = i.VISIT_ID AND i.IS_CANCEL = 0
INNER JOIN staff s ON s.STAFF_ID = a.STAFF_ID
LEFT JOIN population p ON p.CID = s.CID
INNER JOIN cid_hn c ON  c.CID = p.CID
LEFT JOIN opd_visits v ON v.HN = c.HN AND v.IS_CANCEL = 0
LEFT  JOIN prescriptions ps  ON i.VISIT_ID = ps.VISIT_ID 
LEFT  JOIN drugs dr ON dr.DRUG_ID = ps.DRUG_ID
LEFT OUTER JOIN usage_units d ON dr.PACKAGE = d.UUNIT_ID
LEFT JOIN service_units su ON i.WARD_NO = su.UNIT_ID
INNER JOIN routes r ON r.ROUTE_ID = ps.ROUTE_ID
LEFT  JOIN drug_price dp ON dp.drug_id = dr.DRUG_ID 
WHERE   
i.ADM_ID =@an
AND a.RF_TYPE = '2'
and i.IS_CANCEL = 0
GROUP BY dname

[2018-05-24 10:26:02.719] [000076] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:26:02.735] [000076] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:26:02.735] [000076] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/1.693114*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 10:28:24.066] [000079] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:28:24.120] [000079] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:28:24.151] [000079] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:28:24.167] [000079] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:28:26.205] [000078] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:28:26.205] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:26.205] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:26.220] [000078] [localhost] [MYSQL]
SET @vn= '0001907378';

[2018-05-24 10:28:26.220] [000078] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
,'' form_name
,DATE_FORMAT(l.COLLECTED_DT,'%Y%m%d') receive_date
,DATE_FORMAT(l.COLLECTED_DT,'%H%m') receive_time
,v.UNIT_REG department
,a.VISIT_ID vn
,i.ADM_ID  an
,DATE_FORMAT(l.LREQ_DT,'%Y%m%d') order_date
,DATE_FORMAT(l.LREQ_DT,'%H%m') order_time
,l.LREQ_DT datetime_invest
,l.LAB_ID inverstcode
,la.LAB_SNAME investname
,l.LRPT_DT datetime_report
,l.LAB_RESULT investvalue
,'' investunit
,l.LAB_RESULT investresult
,'' lab_items_sub_group_name
,l.TECH_ID provider
,CONCAT( trim(p.FNAME) ,'  ',trim(p.LNAME)) provider_name
,s.LICENCE provider_licenseno
,s.CID provider_cid
,'' confirm
,'' invest_type
,'' invest_local_code
,'' normal_value
FROM  gcoffice , refers a
INNER JOIN lab_requests l ON a.VISIT_ID = l.VISIT_ID AND l.IS_CANCEL = 0
LEFT  JOIN ipd_reg i ON a.VISIT_ID= i.VISIT_ID AND i.IS_CANCEL = 0
INNER JOIN lab_lists la ON l.LAB_ID = la.LAB_ID 
LEFT  JOIN staff s ON s.STAFF_ID = l.TECH_ID 
LEFT  JOIN population p ON s.CID = p.CID 
LEFT  JOIN opd_visits v ON v.VISIT_ID = l.VISIT_ID AND v.IS_CANCEL = 0
WHERE a.VISIT_ID = @vn
AND a.RF_TYPE = 2

[2018-05-24 10:28:26.330] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:26.330] [000078] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:28:26.330] [000078] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.099731*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 10:28:50.269] [000078] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:28:50.269] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:50.269] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:50.284] [000078] [localhost] [MYSQL]
SET @vn= '0001907378';

[2018-05-24 10:28:50.284] [000078] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
,'' form_name
,DATE_FORMAT(l.COLLECTED_DT,'%Y%m%d') receive_date
,DATE_FORMAT(l.COLLECTED_DT,'%H%i') receive_time
,v.UNIT_REG department
,a.VISIT_ID vn
,i.ADM_ID  an
,DATE_FORMAT(l.LREQ_DT,'%Y%m%d') order_date
,DATE_FORMAT(l.LREQ_DT,'%H%m') order_time
,l.LREQ_DT datetime_invest
,l.LAB_ID inverstcode
,la.LAB_SNAME investname
,l.LRPT_DT datetime_report
,l.LAB_RESULT investvalue
,'' investunit
,l.LAB_RESULT investresult
,'' lab_items_sub_group_name
,l.TECH_ID provider
,CONCAT( trim(p.FNAME) ,'  ',trim(p.LNAME)) provider_name
,s.LICENCE provider_licenseno
,s.CID provider_cid
,'' confirm
,'' invest_type
,'' invest_local_code
,'' normal_value
FROM  gcoffice , refers a
INNER JOIN lab_requests l ON a.VISIT_ID = l.VISIT_ID AND l.IS_CANCEL = 0
LEFT  JOIN ipd_reg i ON a.VISIT_ID= i.VISIT_ID AND i.IS_CANCEL = 0
INNER JOIN lab_lists la ON l.LAB_ID = la.LAB_ID 
LEFT  JOIN staff s ON s.STAFF_ID = l.TECH_ID 
LEFT  JOIN population p ON s.CID = p.CID 
LEFT  JOIN opd_visits v ON v.VISIT_ID = l.VISIT_ID AND v.IS_CANCEL = 0
WHERE a.VISIT_ID = @vn
AND a.RF_TYPE = 2

[2018-05-24 10:28:50.378] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:28:50.378] [000078] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:28:50.378] [000078] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.073456*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=12 GROUP BY STATE;

[2018-05-24 10:29:36.816] [000078] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:29:36.816] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:29:36.816] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:29:36.832] [000078] [localhost] [MYSQL]
SET @vn= '0001907378';

[2018-05-24 10:29:36.847] [000078] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
,'' form_name
,DATE_FORMAT(l.COLLECTED_DT,'%Y%m%d') receive_date
,DATE_FORMAT(l.COLLECTED_DT,'%H%i') receive_time
,v.UNIT_REG department
,a.VISIT_ID vn
,i.ADM_ID  an
,DATE_FORMAT(l.LREQ_DT,'%Y%m%d') order_date
,DATE_FORMAT(l.LREQ_DT,'%H%i') order_time
,l.LREQ_DT datetime_invest
,l.LAB_ID inverstcode
,la.LAB_SNAME investname
,l.LRPT_DT datetime_report
,l.LAB_RESULT investvalue
,'' investunit
,l.LAB_RESULT investresult
,'' lab_items_sub_group_name
,l.TECH_ID provider
,CONCAT( trim(p.FNAME) ,'  ',trim(p.LNAME)) provider_name
,s.LICENCE provider_licenseno
,s.CID provider_cid
,'' confirm
,'' invest_type
,'' invest_local_code
,'' normal_value
FROM  gcoffice , refers a
INNER JOIN lab_requests l ON a.VISIT_ID = l.VISIT_ID AND l.IS_CANCEL = 0
LEFT  JOIN ipd_reg i ON a.VISIT_ID= i.VISIT_ID AND i.IS_CANCEL = 0
INNER JOIN lab_lists la ON l.LAB_ID = la.LAB_ID 
LEFT  JOIN staff s ON s.STAFF_ID = l.TECH_ID 
LEFT  JOIN population p ON s.CID = p.CID 
LEFT  JOIN opd_visits v ON v.VISIT_ID = l.VISIT_ID AND v.IS_CANCEL = 0
WHERE a.VISIT_ID = @vn
AND a.RF_TYPE = 2

[2018-05-24 10:29:36.910] [000078] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:29:36.925] [000078] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:29:36.925] [000078] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.058573*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=20 GROUP BY STATE;

[2018-05-24 10:45:35.096] [000081] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:45:35.143] [000081] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:45:35.189] [000081] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:45:35.205] [000081] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:49:55.512] [000062] [localhost] [MYSQL]
SHOW DATABASES

[2018-05-24 10:49:58.260] [000083] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:49:58.307] [000083] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:49:58.338] [000083] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:49:58.369] [000083] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:50:04.653] [000085] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:50:04.700] [000085] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:50:04.731] [000085] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:50:04.746] [000085] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:50:18.429] [000087] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:50:18.460] [000087] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:50:18.507] [000087] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:50:18.522] [000087] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:59:52.424] [000089] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 10:59:52.486] [000089] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 10:59:52.517] [000089] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 10:59:52.533] [000089] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 10:59:55.098] [000088] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 10:59:55.098] [000088] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:59:55.098] [000088] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:59:55.113] [000088] [localhost] [MYSQL]
SET @vn= '0001907378';

[2018-05-24 10:59:55.129] [000088] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID) refer_no
,'' form_name
,DATE_FORMAT(l.COLLECTED_DT,'%Y%m%d') receive_date
,DATE_FORMAT(l.COLLECTED_DT,'%H%i') receive_time
,v.UNIT_REG department
,a.VISIT_ID vn
,i.ADM_ID  an
,DATE_FORMAT(l.LREQ_DT,'%Y%m%d') order_date
,DATE_FORMAT(l.LREQ_DT,'%H%i') order_time
,l.LREQ_DT datetime_invest
,l.LAB_ID inverstcode
,la.LAB_SNAME investname
,l.LRPT_DT datetime_report
,l.LAB_RESULT investvalue
,'' investunit
,l.LAB_RESULT investresult
,'' lab_items_sub_group_name
,l.TECH_ID provider
,CONCAT( trim(p.FNAME) ,'  ',trim(p.LNAME)) provider_name
,s.LICENCE provider_licenseno
,s.CID provider_cid
,'' confirm
,'' invest_type
,'' invest_local_code
,'' normal_value
FROM  gcoffice , refers a
INNER JOIN lab_requests l ON a.VISIT_ID = l.VISIT_ID AND l.IS_CANCEL = 0
LEFT  JOIN ipd_reg i ON a.VISIT_ID= i.VISIT_ID AND i.IS_CANCEL = 0
INNER JOIN lab_lists la ON l.LAB_ID = la.LAB_ID 
LEFT  JOIN staff s ON s.STAFF_ID = l.TECH_ID 
LEFT  JOIN population p ON s.CID = p.CID 
LEFT  JOIN opd_visits v ON v.VISIT_ID = l.VISIT_ID AND v.IS_CANCEL = 0
WHERE a.VISIT_ID = @vn
AND a.RF_TYPE = 2

[2018-05-24 10:59:55.270] [000088] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 10:59:55.285] [000088] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 10:59:55.285] [000088] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.130976*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 11:00:16.666] [000091] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:00:16.729] [000091] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:00:16.760] [000091] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:00:16.776] [000091] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:00:19.054] [000090] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:00:19.054] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:00:19.054] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:00:19.069] [000090] [localhost] [MYSQL]
SET @an = '076540';

[2018-05-24 11:00:19.085] [000090] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid as hcode
,concat(gcoffice.offid,'-3-',a.refer_id) refer_no
,b.adm_id as an
,c.hn as hn
,b.adm_dt as datetime_admit
,''datetime_dch
,concat('1',c.unit_reg, b.ward_no) as wardstay
,b.ward_no as ward_code
,d.unit_name as ward_name
,g.icd9_code as procedcode
,g.nickname as proced_name
,''timestart
,''timefinish
,g.cost as serviceprice
,a.staff_id as provider
,concat(trim(p.fname),' ', trim(p.lname)) as provider_name
,s.licence as provider_licenseno
,s.cid as provider_cid
FROM gcoffice, refers a
INNER JOIN ipd_reg b ON a.visit_id= b.visit_id and b.is_cancel = 0
LEFT JOIN opd_visits c ON a.visit_id = c.visit_id and c.is_cancel=0
INNER JOIN service_units d ON d.unit_id = b.ward_no 
INNER JOIN opd_diagnosis e ON e.VISIT_ID = c.VISIT_ID and e.is_cancel =0
INNER JOIN opd_operations f ON f.visit_id = c.visit_id and f.is_cancel =0
INNER JOIN icd9cm g ON g.icd9 = f.icd9 
INNER JOIN staff s ON s.staff_id = a.staff_id
LEFT JOIN population p ON p.cid = s.cid 
WHERE b.adm_id =@an
and a.is_cancel = 0

[2018-05-24 11:00:19.351] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:00:19.366] [000090] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:00:19.366] [000090] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.266901*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 11:03:48.846] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`ipd_reg`

[2018-05-24 11:04:04.450] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 11:04:04.466] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 11:04:04.466] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 11:04:04.466] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`service_units`

[2018-05-24 11:04:04.466] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_diagnosis`

[2018-05-24 11:04:04.466] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_operations`

[2018-05-24 11:04:04.481] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`icd9cm`

[2018-05-24 11:04:04.481] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`staff`

[2018-05-24 11:04:04.481] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 11:04:08.359] [000090] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:04:08.359] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:04:08.359] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:04:08.359] [000090] [localhost] [MYSQL]
SET @an = '076540';

[2018-05-24 11:04:08.375] [000090] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid as hcode
,concat(gcoffice.offid,'-3-',a.refer_id) refer_no
,b.adm_id as an
,c.hn as hn
,b.adm_dt as datetime_admit
,b.dsc_dt as datetime_dch
,concat('1',c.unit_reg, b.ward_no) as wardstay
,b.ward_no as ward_code
,d.unit_name as ward_name
,g.icd9_code as procedcode
,g.nickname as proced_name
,''timestart
,''timefinish
,g.cost as serviceprice
,a.staff_id as provider
,concat(trim(p.fname),' ', trim(p.lname)) as provider_name
,s.licence as provider_licenseno
,s.cid as provider_cid
FROM gcoffice, refers a
INNER JOIN ipd_reg b ON a.visit_id= b.visit_id and b.is_cancel = 0
LEFT JOIN opd_visits c ON a.visit_id = c.visit_id and c.is_cancel=0
INNER JOIN service_units d ON d.unit_id = b.ward_no 
INNER JOIN opd_diagnosis e ON e.VISIT_ID = c.VISIT_ID and e.is_cancel =0
INNER JOIN opd_operations f ON f.visit_id = c.visit_id and f.is_cancel =0
INNER JOIN icd9cm g ON g.icd9 = f.icd9 
INNER JOIN staff s ON s.staff_id = a.staff_id
LEFT JOIN population p ON p.cid = s.cid 
WHERE b.adm_id =@an
and a.is_cancel = 0

[2018-05-24 11:04:08.438] [000090] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:04:08.438] [000090] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:04:08.438] [000090] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.043906*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=12 GROUP BY STATE;

[2018-05-24 11:05:24.377] [000093] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:05:24.424] [000093] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:05:24.456] [000093] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:05:24.487] [000093] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:05:26.067] [000092] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:05:26.067] [000092] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:05:26.067] [000092] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:05:26.082] [000092] [localhost] [MYSQL]
SET @vn = '0001907388';

[2018-05-24 11:05:26.082] [000092] [localhost] [MYSQL]
SET @vn_ipd = (select visit_id FROM ipd_reg limit 1);

[2018-05-24 11:05:26.098] [000092] [localhost] [MYSQL]
SELECT DISTINCT
gcoffice.offid AS hcode
,CONCAT(gcoffice.offid,'-3-',a.REFER_ID)refer_no
,a.VISIT_ID vn
,b.HN hn
,DATE_FORMAT(b.REG_DATETIME,'%Y%m%d') date_serv
,DATE_FORMAT(b.REG_DATETIME,'%H%m') time_serv
,CONCAT('0',b.UNIT_REG,f.DXG_ID) clinic
, b.UNIT_REG clinic_code
, d.UNIT_NAME clinic_name
, e.ICD9_CODE procedcode
,e.COST serviceprice
,a.STAFF_ID provider
,CONCAT(trim(p.fname),'  ',trim(p.lname)) provider_name
,g.LICENCE provider_licenseno
,g.CID provider_cid
,e.NICKNAME proced_name
,'' type
FROM gcoffice , refers a
INNER JOIN opd_visits b ON a.VISIT_ID = b.VISIT_ID AND b.IS_CANCEL = 0
INNER JOIN opd_operations c ON a.VISIT_ID = c.VISIT_ID AND c.IS_CANCEL = 0
INNER JOIN service_units d ON d.UNIT_ID = b.UNIT_REG
INNER JOIN icd9cm e ON e.ICD9 = c.icd9 
INNER JOIN opd_diagnosis f ON f.VISIT_ID = b.VISIT_ID AND f.IS_CANCEL = 0
INNER JOIN staff g ON g.STAFF_ID = a.STAFF_ID 
LEFT JOIN population p ON p.CID = g.CID
WHERE a.VISIT_ID = @vn
AND a.IS_CANCEL =0
AND b.VISIT_ID NOT IN (@vn_ipd)

[2018-05-24 11:05:26.207] [000092] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:05:26.207] [000092] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:05:26.207] [000092] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.093156*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=5 GROUP BY STATE;

[2018-05-24 11:09:07.848] [000095] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:09:07.895] [000095] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:09:07.926] [000095] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:09:07.942] [000095] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:10:20.390] [000094] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:10:20.390] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:10:20.390] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:10:20.405] [000094] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:10:20.421] [000094] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,'' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) as refer_no ,c.icd10_tm as icd10 ,b.dxt_id ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' 
WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' 
WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' 
WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' 
ELSE '5' END as diagtype_id 
FROM gcoffice, refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.visit_id = @vn AND a.is_cancel = 0

[2018-05-24 11:10:20.483] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:10:20.483] [000094] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:10:20.483] [000094] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.059679*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 11:11:00.334] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 11:11:04.162] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 11:11:04.178] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_diagnosis`

[2018-05-24 11:11:04.178] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`icd10new`

[2018-05-24 11:11:57.262] [000094] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:11:57.262] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:11:57.262] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:11:57.277] [000094] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:11:57.277] [000094] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,'' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) as refer_no ,c.icd10_tm as icd10 ,b.dxt_id ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' 
WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' 
WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' 
WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' 
ELSE '5' END as diagtype_id 
,a.VISIT_ID 
FROM gcoffice, refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.RF_DT >2018.01.01
#a.visit_id = @vn 
AND a.is_cancel = 0

[2018-05-24 11:11:57.277] [000094] [localhost] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '.01
#a.visit_id = @vn 
AND a.is_cancel = 0' at line 16

[2018-05-24 11:12:15.655] [000094] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:12:15.655] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:15.655] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:15.655] [000094] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:12:15.671] [000094] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,'' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) as refer_no ,c.icd10_tm as icd10 ,b.dxt_id ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' 
WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' 
WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' 
WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' 
ELSE '5' END as diagtype_id 
,a.VISIT_ID 
FROM gcoffice, refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.RF_DT > '2018.01.01'
#a.visit_id = @vn 
AND a.is_cancel = 0

[2018-05-24 11:12:16.759] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:16.759] [000094] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:12:16.759] [000094] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/1.082282*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=17 GROUP BY STATE;

[2018-05-24 11:12:45.254] [000094] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:12:45.254] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:45.254] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:45.254] [000094] [localhost] [MYSQL]
SET @vn = '0001907378';

[2018-05-24 11:12:45.269] [000094] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,'' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) as refer_no ,c.icd10_tm as icd10 ,b.dxt_id ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' 
WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' 
WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' 
WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' 
ELSE '5' END as diagtype_id 
FROM gcoffice, refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.visit_id = @vn 
AND a.is_cancel = 0

[2018-05-24 11:12:45.335] [000094] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:12:45.335] [000094] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:12:45.335] [000094] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.056884*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=25 GROUP BY STATE;

[2018-05-24 11:13:30.187] [000097] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:13:30.234] [000097] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:13:30.265] [000097] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:13:30.265] [000097] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:14:37.810] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 11:14:41.601] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 11:14:41.616] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_diagnosis`

[2018-05-24 11:14:41.632] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`icd10new`

[2018-05-24 11:16:12.022] [000096] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:16:12.022] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:16:12.022] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:16:12.022] [000096] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:16:12.037] [000096] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode , '' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) refer_no ,c.icd10_tm as icd10 ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' ELSE '5' END as diagtype_id 
,a.visit_id 
FROM gcoffice , refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 WHERE a.visit_id = @vn AND a.is_cancel = 0
WHERE a.rf_dt > '2018.01.01'
AND a.is_cancel = 0

[2018-05-24 11:16:12.037] [000096] [localhost] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'WHERE a.rf_dt > '2018.01.01'
AND a.is_cancel = 0' at line 12

[2018-05-24 11:16:56.550] [000096] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:16:56.550] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:16:56.550] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:16:56.550] [000096] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:16:56.566] [000096] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode , '' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) refer_no ,c.icd10_tm as icd10 ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' ELSE '5' END as diagtype_id 
,a.visit_id 
FROM gcoffice , refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.rf_dt > '2018.01.01'
AND a.is_cancel = 0 
a.visit_id = @vn

[2018-05-24 11:16:56.566] [000096] [localhost] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'a.visit_id = @vn' at line 14

[2018-05-24 11:17:03.946] [000096] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:17:03.946] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:03.946] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:03.946] [000096] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:17:03.962] [000096] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode , '' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) refer_no ,c.icd10_tm as icd10 ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' ELSE '5' END as diagtype_id 
,a.visit_id 
FROM gcoffice , refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.rf_dt > '2018.01.01'
AND a.is_cancel = 0 
#a.visit_id = @vn

[2018-05-24 11:17:04.024] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:04.024] [000096] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:17:04.024] [000096] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.054045*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=14 GROUP BY STATE;

[2018-05-24 11:17:46.796] [000096] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:17:46.796] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:46.796] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:46.796] [000096] [localhost] [MYSQL]
SET @vn = '0001907378';

[2018-05-24 11:17:46.812] [000096] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode , '' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) refer_no ,c.icd10_tm as icd10 ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' ELSE '5' END as diagtype_id 
,a.visit_id 
FROM gcoffice , refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.visit_id = @vn
AND a.is_cancel = 0

[2018-05-24 11:17:46.874] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:17:46.890] [000096] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:17:46.890] [000096] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.062721*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=22 GROUP BY STATE;

[2018-05-24 11:18:01.831] [000096] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:18:01.831] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:18:01.846] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:18:01.846] [000096] [localhost] [MYSQL]
SET @vn = '0001907378';

[2018-05-24 11:18:01.862] [000096] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode , '' rec_no ,concat(gcoffice.offid, '-3-', a.refer_id ) refer_no ,c.icd10_tm as icd10 ,
CASE WHEN b.dxt_id = 01 THEN '1' 
WHEN b.dxt_id = 02 THEN '5' 
WHEN b.dxt_id = 03 THEN '3' WHEN b.dxt_id = 04 THEN '4' 
WHEN b.dxt_id = 05 THEN '5' WHEN b.dxt_id = 06 THEN '6' 
WHEN b.dxt_id = 07 THEN '7' WHEN b.dxt_id = 08 THEN '8' 
WHEN b.dxt_id = 09 THEN '9' ELSE '5' END as diagtype_id FROM gcoffice , refers a 
INNER JOIN opd_diagnosis b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
INNER JOIN icd10new c ON b.icd10 = c.icd10 
WHERE a.visit_id = @vn
AND a.is_cancel = 0

[2018-05-24 11:18:01.924] [000096] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:18:01.940] [000096] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:18:01.940] [000096] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.070398*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=30 GROUP BY STATE;

[2018-05-24 11:19:01.417] [000099] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-05-24 11:19:01.464] [000099] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-05-24 11:19:01.495] [000099] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-05-24 11:19:01.527] [000099] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-05-24 11:19:45.615] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`refers`

[2018-05-24 11:20:33.635] [000098] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:20:33.635] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:20:33.635] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:20:33.650] [000098] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:20:33.666] [000098] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,concat(gcoffice.offid,'-3-', a.refer_id) as refer_no ,d.birthdate as birthday ,d.telephone as tel 
,d.marriage as marrystatus ,d.natn_id as nationality ,d.oc_id as citizenship ,d.religion as religion 
,d.oc_id as occupation ,d.mother AS mather_name ,d.father as father_name ,d.contact as contact_name ,a.visit_id 
,'' contact_relation ,d.CONTACT_ADR as contact_addr FROM gcoffice , refers a 
LEFT JOIN opd_visits b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
LEFT JOIN cid_hn c ON b.hn = c.hn 
LEFT JOIN population d ON c.cid = d.cid 

WHERE a.rf_dt > '2018.01.01' AND a.is_cancel = 0

[2018-05-24 11:20:36.244] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:20:36.260] [000098] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:20:36.260] [000098] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/2.585691*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=4 GROUP BY STATE;

[2018-05-24 11:21:13.485] [000098] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:21:13.485] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:21:13.485] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:21:13.485] [000098] [localhost] [MYSQL]
SET @vn = '?p0';

[2018-05-24 11:21:13.501] [000098] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,concat(gcoffice.offid,'-3-', a.refer_id) as refer_no ,d.birthdate as birthday ,d.telephone as tel 
,d.marriage as marrystatus ,d.natn_id as nationality ,d.oc_id as citizenship ,d.religion as religion 
,d.oc_id as occupation ,d.mother AS mather_name ,d.father as father_name ,d.contact as contact_name 
,'' contact_relation ,d.CONTACT_ADR as contact_addr,a.visit_id 
 FROM gcoffice , refers a 
LEFT JOIN opd_visits b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
LEFT JOIN cid_hn c ON b.hn = c.hn 
LEFT JOIN population d ON c.cid = d.cid 

WHERE a.rf_dt > '2018.01.01' AND a.is_cancel = 0

[2018-05-24 11:21:13.579] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:21:13.579] [000098] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:21:13.579] [000098] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.073223*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=12 GROUP BY STATE;

[2018-05-24 11:22:02.029] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`gcoffice`

[2018-05-24 11:22:02.045] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-05-24 11:22:02.045] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-05-24 11:22:02.045] [000063] [localhost] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-05-24 11:22:26.127] [000098] [localhost] [MYSQL]
SET PROFILING=1;

[2018-05-24 11:22:26.127] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:22:26.127] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:22:26.143] [000098] [localhost] [MYSQL]
SET @vn = '0001907272';

[2018-05-24 11:22:26.143] [000098] [localhost] [MYSQL]
SELECT DISTINCT gcoffice.offid as hcode ,concat(gcoffice.offid,'-3-', a.refer_id) as refer_no ,d.birthdate as birthday ,d.telephone as tel 
,d.marriage as marrystatus ,d.natn_id as nationality ,d.oc_id as citizenship ,d.religion as religion 
,d.oc_id as occupation ,d.mother AS mather_name ,d.father as father_name ,d.contact as contact_name 
,'' contact_relation ,d.CONTACT_ADR as contact_addr
 FROM gcoffice , refers a 
LEFT JOIN opd_visits b ON a.visit_id = b.visit_id AND b.is_cancel = 0 
LEFT JOIN cid_hn c ON b.hn = c.hn 
LEFT JOIN population d ON c.cid = d.cid 
WHERE a.visit_id =@vn
AND a.is_cancel = 0

[2018-05-24 11:22:26.221] [000098] [localhost] [MYSQL]
SHOW STATUS

[2018-05-24 11:22:26.221] [000098] [localhost] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-05-24 11:22:26.221] [000098] [localhost] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.061310*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=20 GROUP BY STATE;

>>>>>>> 5de76d7f130a0a924cad0a4c422c12b1397ac875
