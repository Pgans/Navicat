[2018-06-18 11:17:32.992] [001974] [samba3] [MYSQL]
SHOW VARIABLES LIKE 'lower_case_%'

[2018-06-18 11:17:33.008] [001974] [samba3] [MYSQL]
SHOW VARIABLES LIKE 'profiling'

[2018-06-18 11:17:33.008] [001974] [samba3] [MYSQL]
SHOW DATABASES

[2018-06-18 11:17:35.665] [001975] [samba3] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-06-18 11:17:35.712] [001975] [samba3] [MYSQL]
SHOW FULL TABLES WHERE Table_type != 'VIEW'

[2018-06-18 11:17:41.755] [001977] [samba3] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-06-18 11:17:41.755] [001977] [samba3] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-06-18 11:17:41.771] [001977] [samba3] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-06-18 11:17:42.225] [001977] [samba3] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-06-18 11:17:56.668] [001979] [samba3] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-06-18 11:17:56.684] [001979] [samba3] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-06-18 11:17:56.699] [001979] [samba3] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-06-18 11:17:56.762] [001979] [samba3] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-06-18 11:19:17.719] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_visits`

[2018-06-18 11:19:41.499] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-06-18 11:19:41.499] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`cid_hn`

[2018-06-18 11:22:45.738] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`opd_diagnosis`

[2018-06-18 11:24:05.200] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`icd10new`

[2018-06-18 11:27:48.326] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:27:48.341] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:27:48.373] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:27:48.388] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' AND e.icd10_tm BETWEEN 'F18' AND 'F19'
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cacel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
LIMIT 10 ;

[2018-06-18 11:27:48.388] [001978] [samba3] [MYSQL]
1054 - Unknown column 'c.is_cacel' in 'where clause'

[2018-06-18 11:28:07.966] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:28:07.966] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:07.981] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:07.981] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' AND e.icd10_tm BETWEEN 'F18' AND 'F19'
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
LIMIT 10 ;

[2018-06-18 11:28:08.075] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:08.091] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:28:08.091] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.086439*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=7 GROUP BY STATE;

[2018-06-18 11:28:30.063] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:28:30.063] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:30.063] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:30.079] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' 
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
LIMIT 10 ;

[2018-06-18 11:28:31.096] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:31.111] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:28:31.111] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/1.014911*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=14 GROUP BY STATE;

[2018-06-18 11:28:45.779] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:28:45.779] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:45.795] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:45.795] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' 
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND e.icd10_tm BETWEEN 'F18' AND 'F19'
LIMIT 10 ;

[2018-06-18 11:28:45.810] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:28:45.810] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:28:45.826] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.001270*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=21 GROUP BY STATE;

[2018-06-18 11:29:08.285] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:29:08.285] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:08.285] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:08.300] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
LIMIT 10 ;

[2018-06-18 11:29:08.441] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:08.441] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:29:08.441] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.127617*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=28 GROUP BY STATE;

[2018-06-18 11:29:30.726] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:29:30.726] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:30.726] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:30.742] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
 ;

[2018-06-18 11:29:30.804] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:29:30.820] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:29:30.820] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.064590*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=35 GROUP BY STATE;

[2018-06-18 11:47:53.816] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:47:53.816] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:47:53.816] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:47:53.832] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
 GROUP BY c.HN ORDER BY c.HN ;

[2018-06-18 11:47:53.832] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:47:53.847] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:47:53.847] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.005621*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=42 GROUP BY STATE;

[2018-06-18 11:50:39.124] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:50:39.139] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:50:39.139] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:50:39.139] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2009.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
 GROUP BY c.HN ORDER BY c.HN ;

[2018-06-18 11:50:39.359] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:50:39.375] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:50:39.375] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.199113*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=49 GROUP BY STATE;

[2018-06-18 11:51:05.118] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:51:05.118] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:51:05.118] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:51:05.133] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
 GROUP BY c.HN ORDER BY c.HN ;

[2018-06-18 11:51:05.196] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:51:05.211] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:51:05.211] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.066405*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=56 GROUP BY STATE;

[2018-06-18 11:52:18.740] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:52:18.740] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:52:18.740] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:52:18.740] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , c.HN , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
 GROUP BY c.HN ORDER BY c.HN ;

[2018-06-18 11:52:18.912] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:52:18.912] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:52:18.928] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.145730*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=63 GROUP BY STATE;

[2018-06-18 11:52:51.713] [001975] [samba3] [MYSQL]
SHOW CREATE TABLE `deaths`

[2018-06-18 11:52:51.900] [001980] [samba3] [MYSQL]
SELECT * FROM `deaths` LIMIT 0, 1000

[2018-06-18 11:52:51.963] [001980] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`deaths`

[2018-06-18 11:53:58.685] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:53:58.685] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:53:58.701] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:53:58.701] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME, a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 11:53:58.748] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:53:58.748] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:53:58.748] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030010*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=70 GROUP BY STATE;

[2018-06-18 11:58:32.468] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:58:32.468] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:58:32.468] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:58:32.484] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
 a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 11:58:32.484] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'a.SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_vis' at line 5

[2018-06-18 11:59:02.805] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:59:02.805] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:02.820] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:02.820] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, a.BIRTHDATE, e.ICD10_TM, e.ICD_NAME
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 11:59:02.867] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:02.867] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:59:02.883] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029915*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=81 GROUP BY STATE;

[2018-06-18 11:59:32.741] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 11:59:32.741] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:32.741] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:32.757] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 11:59:32.788] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 11:59:32.788] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 11:59:32.804] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030337*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=88 GROUP BY STATE;

[2018-06-18 12:03:13.480] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:03:13.480] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:13.495] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:13.495] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2004.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:03:13.542] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:13.542] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:03:13.558] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030459*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=95 GROUP BY STATE;

[2018-06-18 12:03:53.550] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:03:53.550] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:53.550] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:53.550] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2018.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:03:53.612] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:03:53.612] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:03:53.612] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029033*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=102 GROUP BY STATE;

[2018-06-18 12:04:01.491] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:01.491] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:01.491] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:01.506] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2017.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:01.569] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:01.584] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:01.584] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.060006*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=109 GROUP BY STATE;

[2018-06-18 12:04:07.335] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:07.335] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:07.351] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:07.351] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2016.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:07.413] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:07.413] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:07.413] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.050769*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=116 GROUP BY STATE;

[2018-06-18 12:04:15.900] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:15.900] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:15.900] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:15.916] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2015.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:15.963] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:15.979] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:15.979] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.049418*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=123 GROUP BY STATE;

[2018-06-18 12:04:25.545] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:25.545] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:25.561] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:25.561] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2014.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:25.624] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:25.624] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:25.624] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.045913*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=130 GROUP BY STATE;

[2018-06-18 12:04:31.489] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:31.489] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:31.505] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:31.505] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2012.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:31.567] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:31.583] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:31.583] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.055913*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=137 GROUP BY STATE;

[2018-06-18 12:04:39.144] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:39.159] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:39.159] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:39.159] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2014.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:39.175] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:39.191] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:39.191] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.000298*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=144 GROUP BY STATE;

[2018-06-18 12:04:45.470] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:04:45.470] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:45.470] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:45.486] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2012.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:04:45.486] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:04:45.502] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:04:45.502] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.000275*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=151 GROUP BY STATE;

[2018-06-18 12:05:05.493] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:05:05.493] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:05.493] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:05.508] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2011.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:05:05.555] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:05.555] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:05:05.555] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.039482*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=158 GROUP BY STATE;

[2018-06-18 12:05:20.081] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:05:20.081] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:20.081] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:20.097] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2011.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:05:20.112] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:20.112] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:05:20.112] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.000281*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=165 GROUP BY STATE;

[2018-06-18 12:05:27.140] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:05:27.140] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:27.140] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:27.155] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2008.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:05:27.218] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:27.218] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:05:27.218] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.047368*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=172 GROUP BY STATE;

[2018-06-18 12:05:33.818] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:05:33.818] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:33.833] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:33.833] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2007.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:05:33.896] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:33.896] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:05:33.911] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.048106*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=179 GROUP BY STATE;

[2018-06-18 12:05:50.086] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:05:50.086] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:50.086] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:50.086] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.reg_datetime > '2002.01.01'
AND c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:05:50.171] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:05:50.186] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:05:50.186] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.071281*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=186 GROUP BY STATE;

[2018-06-18 12:06:03.421] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:06:03.421] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:03.421] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:03.421] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
#GROUP BY c.HN ;

[2018-06-18 12:06:03.468] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:03.468] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:06:03.468] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029125*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=193 GROUP BY STATE;

[2018-06-18 12:06:09.017] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:06:09.017] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:09.017] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:09.033] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 12:06:09.064] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:06:09.079] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:06:09.079] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.028945*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=200 GROUP BY STATE;

[2018-06-18 12:08:22.143] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:08:22.143] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:22.143] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:22.159] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
DATEDIFF(NOW(),a.BIRTHDATE)/365.25 AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 12:08:22.190] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:22.205] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:08:22.205] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029577*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=207 GROUP BY STATE;

[2018-06-18 12:08:41.575] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:08:41.575] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:41.575] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:41.590] [001978] [samba3] [MYSQL]
SELECT c.REG_DATETIME , a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 12:08:41.622] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:08:41.622] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:08:41.622] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029429*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=214 GROUP BY STATE;

[2018-06-18 12:09:27.001] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 12:09:27.001] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:09:27.016] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:09:27.016] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 12:09:27.063] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 12:09:27.063] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 12:09:27.063] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029783*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=221 GROUP BY STATE;

[2018-06-18 13:02:52.152] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:02:52.152] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:02:52.168] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:02:52.168] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
#INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' 
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:02:52.215] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:02:52.215] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:02:52.215] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.028643*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=228 GROUP BY STATE;

[2018-06-18 13:03:30.392] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:03:30.392] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:03:30.408] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:03:30.408] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
#INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
#INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F11' AND 'F16' 
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND e.icd10_tm BETWEEN 'F18' AND 'F19' 
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:03:30.439] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:03:30.455] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:03:30.455] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.025589*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=235 GROUP BY STATE;

[2018-06-18 13:04:12.336] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:04:12.336] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:04:12.351] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:04:12.351] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:04:12.398] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:04:12.398] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:04:12.398] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.029534*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=242 GROUP BY STATE;

[2018-06-18 13:06:40.988] [001975] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`towns`

[2018-06-18 13:07:18.835] [001975] [samba3] [MYSQL]
SHOW CREATE TABLE `population`

[2018-06-18 13:07:18.928] [001981] [samba3] [MYSQL]
SELECT * FROM `population` LIMIT 0, 1000

[2018-06-18 13:07:19.007] [001981] [samba3] [MYSQL]
SHOW COLUMNS FROM `mbase_data`.`population`

[2018-06-18 13:07:36.593] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:07:36.593] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:07:36.593] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:07:36.609] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.TOWN_ID 
INNER JOIN towns g
INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:07:36.609] [001978] [samba3] [MYSQL]
1054 - Unknown column 'a.TOWN_ID' in 'on clause'

[2018-06-18 13:21:24.793] [000003] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'lower_case_%'

[2018-06-18 13:21:24.793] [000003] [localhost] [MYSQL]
SHOW VARIABLES LIKE 'profiling'

[2018-06-18 13:21:24.809] [000003] [localhost] [MYSQL]
SHOW DATABASES

[2018-06-18 13:21:26.200] [000004] [localhost] [MYSQL]
SELECT @@character_set_database, @@collation_database

[2018-06-18 13:21:32.725] [000006] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type != 'VIEW'

[2018-06-18 13:21:32.983] [000006] [localhost] [MYSQL]
SHOW FULL TABLES FROM `mbase_data` WHERE Table_type = 'VIEW'

[2018-06-18 13:21:33.047] [000006] [localhost] [MYSQL]
SHOW PROCEDURE STATUS WHERE Db='mbase_data'

[2018-06-18 13:21:33.063] [000006] [localhost] [MYSQL]
SHOW FUNCTION STATUS WHERE Db='mbase_data'

[2018-06-18 13:25:12.634] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:25:12.634] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:25:12.634] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:25:12.650] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR, f.town_id 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:25:12.650] [001978] [samba3] [MYSQL]
1054 - Unknown column 'a.town_id' in 'on clause'

[2018-06-18 13:25:42.067] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:25:42.067] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:25:42.067] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:25:42.083] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR, f.town_id 
FROM population a, cid_hn b ,opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid = b.cid 
AND b.hn = c.hn 
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:25:42.083] [001978] [samba3] [MYSQL]
1054 - Unknown column 'a.town_id' in 'on clause'

[2018-06-18 13:27:35.574] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:27:35.574] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:27:35.574] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:27:35.589] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR
FROM population a ON a.cid = b.cid
INNER JOIN cid_hn b ON b.hn = c.hn
INNER JOIN opd_visits c
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:27:35.589] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'ON a.cid = b.cid
INNER JOIN cid_hn b ON b.hn = c.hn
INNER JOIN opd_visits c
I' at line 8

[2018-06-18 13:28:30.127] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:28:30.127] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:30.143] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:30.143] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:28:30.236] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:30.236] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:28:30.236] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.071007*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=265 GROUP BY STATE;

[2018-06-18 13:28:44.149] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:28:44.149] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:44.149] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:44.164] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR, f.TOWN_NAME 
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:28:44.227] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:28:44.227] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:28:44.242] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.054467*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=272 GROUP BY STATE;

[2018-06-18 13:29:03.144] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:29:03.144] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:03.144] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:03.159] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR, f.TOWN_NAME AS 'หมู่บ้าน'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:29:03.190] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:03.206] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:29:03.206] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030763*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=279 GROUP BY STATE;

[2018-06-18 13:29:38.463] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:29:38.463] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:38.463] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:38.478] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS HOME, f.TOWN_NAME AS MOOBAN
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:29:38.510] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:38.525] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:29:38.525] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030536*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=286 GROUP BY STATE;

[2018-06-18 13:29:50.416] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:29:50.416] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:50.416] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:50.432] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:29:50.432] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits ' at line 8

[2018-06-18 13:29:58.953] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:29:58.953] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:58.969] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:58.969] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
#INNER JOIN towns g 
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:29:59.015] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:29:59.015] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:29:59.015] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.030369*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=297 GROUP BY STATE;

[2018-06-18 13:32:39.037] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:32:39.037] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:32:39.053] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:32:39.053] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(left,a.town_id6) = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:32:39.053] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'a.town_id6) = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid N' at line 14

[2018-06-18 13:32:55.077] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:32:55.077] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:32:55.077] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:32:55.093] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(left,a.town_id,6) = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:32:55.093] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'a.town_id,6) = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid ' at line 14

[2018-06-18 13:33:33.585] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:33:33.585] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:33:33.601] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:33:33.601] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(left,a.town_id,6),'00' = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:33:33.601] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'a.town_id,6),'00' = g.town_id
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a' at line 14

[2018-06-18 13:34:32.633] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:34:32.633] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:34:32.649] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:34:32.649] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(LEFT(a.town_id,6),'00')= g.TOWN_ID
#INNER JOIN towns h
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:34:32.696] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:34:32.696] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:34:32.713] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.031958*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=316 GROUP BY STATE;

[2018-06-18 13:36:34.205] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:36:34.205] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:36:34.205] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:36:34.220] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON', h.town_name AS 'AMPOR'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(LEFT(a.town_id,6),'00')= g.TOWN_ID
INNER JOIN towns h ON CONCAT(LEFT(a.town_id,),'0000')= h.TOWN_ID
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:36:34.220] [001978] [samba3] [MYSQL]
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '),'0000')= h.TOWN_ID
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM d' at line 15

[2018-06-18 13:36:49.303] [001978] [samba3] [MYSQL]
SET PROFILING=1;

[2018-06-18 13:36:49.303] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:36:49.303] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:36:49.318] [001978] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON', h.town_name AS 'AMPOR'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(LEFT(a.town_id,6),'00')= g.TOWN_ID
INNER JOIN towns h ON CONCAT(LEFT(a.town_id,4),'0000')= h.TOWN_ID
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

[2018-06-18 13:36:49.365] [001978] [samba3] [MYSQL]
SHOW STATUS

[2018-06-18 13:36:49.365] [001978] [samba3] [MYSQL]
SELECT QUERY_ID, SUM(DURATION) AS SUM_DURATION FROM INFORMATION_SCHEMA.PROFILING GROUP BY QUERY_ID;

[2018-06-18 13:36:49.365] [001978] [samba3] [MYSQL]
SELECT STATE AS `Status`, ROUND(SUM(DURATION),7) AS `Duration`, CONCAT(ROUND(SUM(DURATION)/0.033342*100,3), '%') AS `Percentage` FROM INFORMATION_SCHEMA.PROFILING WHERE QUERY_ID=327 GROUP BY STATE;

[2018-06-18 13:58:56.639] [001983] [samba3] [MYSQL]
SELECT  a.CID , a.FNAME, a.LNAME,
CASE 
WHEN a.SEX = 1 THEN 'ชาย'
WHEN a.SEX = 2 THEN 'หญิง'
END AS SEX, 
floor(DATEDIFF(NOW(),a.BIRTHDATE)/365.25) AS AGE,
e.ICD10_TM, e.ICD_NAME , a.HOME_ADR AS 'HOME', f.TOWN_NAME AS 'MOOBAN',g.town_name AS 'TUMBON', h.town_name AS 'AMPOR'
FROM population a 
INNER JOIN cid_hn b ON a.cid = b.cid
INNER JOIN opd_visits c  ON b.hn = c.hn
INNER JOIN opd_diagnosis d ON c.visit_id = d.visit_id AND d.is_cancel =0
INNER JOIN icd10new e ON d.icd10 = e.icd10 AND (e.icd10_tm BETWEEN 'F11' AND 'F16' OR e.icd10_tm BETWEEN 'F18' AND 'F19')
INNER JOIN towns f ON a.town_id = f.town_id 
INNER JOIN towns g ON CONCAT(LEFT(a.town_id,6),'00')= g.TOWN_ID
INNER JOIN towns h ON CONCAT(LEFT(a.town_id,4),'0000')= h.TOWN_ID
WHERE c.is_cancel = 0
AND a.cid NOT IN (SELECT cid FROM deaths)
GROUP BY c.HN ;

